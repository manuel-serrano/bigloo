#*=====================================================================*/
#*    serrano/prgm/project/bigloo/wasm/api/dom/recette/Makefile        */
#*    -------------------------------------------------------------    */
#*    Author      :  Manuel Serrano                                    */
#*    Creation    :  Mon Jan  7 14:55:33 2002                          */
#*    Last change :  Thu Sep 11 08:08:22 2025 (serrano)                */
#*    Copyright   :  2002-25 Manuel Serrano                            */
#*    -------------------------------------------------------------    */
#*    The Makefile to build the tests                                  */
#*=====================================================================*/

#*---------------------------------------------------------------------*/
#*    Standard path                                                    */
#*---------------------------------------------------------------------*/
include ../../../Makefile.buildconfig 
include ../../../Makefile.config 

#*---------------------------------------------------------------------*/
#*    Bigloo                                                           */
#*---------------------------------------------------------------------*/
BCFLAGS= 

#*---------------------------------------------------------------------*/
#*    Objects and sources                                              */
#*---------------------------------------------------------------------*/
SCM_FILE=recette

#*---------------------------------------------------------------------*/
#*    All objects and sources                                          */
#*---------------------------------------------------------------------*/
POPULATION=recette.scm Makefile

#*---------------------------------------------------------------------*/
#*    the goals.                                                       */
#*---------------------------------------------------------------------*/
all: c jvm

c:
jvm:
wasm:
	@ if [ "$(WASMBACKEND)" = "yes" ]; then \
             $(MAKE) recette-wasm$(SCRIPTEXTENSION); \
	  fi

recette-wasm$(SCRIPTEXTENSION): recette.wasm
	$(BIGLOO) $(EFLAGS) -wasm $(BFLAGS) recette.wasm -o recette-wasm$(SCRIPTEXTENSION)

pop:
	@ echo $(POPULATION:%=dom/recette/%)

clean:
	@- $(RM) -f *~ '#*#' core
	@- $(RM) -f *.wasm recette-wasm$(SCRIPTEXTEBSION) 

#*---------------------------------------------------------------------*/
#*    Suffixes                                                         */
#*---------------------------------------------------------------------*/
.SUFFIXES:
.SUFFIXES: .bgl .scm .o .wasm

#*---------------------------------------------------------------------*/
#*    .scm -> .wasm                                                    */
#*---------------------------------------------------------------------*/
.scm.wasm:
	$(BIGLOO) -c -wasm $(EFLAGS) $(BCFLAGS) $(BFLAGS) $*.scm -o $*.wasm
