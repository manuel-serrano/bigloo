;*---------------------------------------------------------------------*/
;*    serrano/prgm/project/bigloo/wasm/recette/vararity.scm            */
;*                                                                     */
;*    Author      :  Manuel Serrano                                    */
;*    Creation    :  Wed Mar 18 15:32:05 1992                          */
;*    Last change :  Thu Oct  9 15:02:50 2025 (serrano)                */
;*                                                                     */
;*    Les tests sur les aritees variables                              */
;*---------------------------------------------------------------------*/

;*---------------------------------------------------------------------*/
;*    Le module                                                        */
;*---------------------------------------------------------------------*/
(module vararity
   (import (utils "utils.scm"))
   (include "test.sch")
   (export (test-vararity)
	   (dsssl3 a #!optional b (c 'c) (d 'd))
	   (dsssl3b a #!key b (c 'c) (d 'd))))

;*---------------------------------------------------------------------*/
;*    test 1.                                                          */
;*---------------------------------------------------------------------*/
(define (test1 a b)
   (labels ((f1 x x)
	    (f2 (x . y) x))
      (f1 (f2 a) b)))

;*---------------------------------------------------------------------*/
;*    test 2.                                                          */
;*---------------------------------------------------------------------*/
(define (test2 a b . c)
   c)

;*---------------------------------------------------------------------*/
;*    test 3.                                                          */
;*---------------------------------------------------------------------*/
(define (test3 . c)
   c)

;*---------------------------------------------------------------------*/
;*    dsssl3                                                           */
;*---------------------------------------------------------------------*/
(define (dsssl3 a #!optional b (c 'c) (d 'd))
   (list a b c d))

;*---------------------------------------------------------------------*/
;*    dsssl3b                                                          */
;*---------------------------------------------------------------------*/
(define (dsssl3b a #!key b (c 'c) (d 'd))
   (list a b c d))

;*---------------------------------------------------------------------*/
;*    test-vararity ...                                                */
;*---------------------------------------------------------------------*/
(define (test-vararity)
   (test-module "vararity" "vararity.scm")
   (test "vararity" (test1 1 2) (list 1 2))
   (test "vararity" (test2 -1 0 1 2) (list 1 2))
   (test "vararity" (test3 1 2) (list 1 2)))
